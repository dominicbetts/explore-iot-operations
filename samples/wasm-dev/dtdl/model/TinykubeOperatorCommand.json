[
  {
    "@context": [
      "dtmi:dtdl:context;3",
      "dtmi:dtdl:extension:mqtt;1"
    ],
    "@id": "dtmi:com:microsoft:azure:tinykube:operator;1",
    "@type": [ "Interface", "Mqtt" ],
    "payloadFormat": "Json/ecma/404",
    "commandTopic": "tinykube/{executorId}/operator/command/{commandName}",
    "contents": [
      {
        "@type": "Command",
        "name": "startModule",
        "request": {
          "name": "reqParams",
          "schema": {
            "@type": "Object",
            "fields": [
              {
                "name": "appId",
                "schema": "string"
              },
              {
                "name": "rpcStartModuleReqParams",
                "schema": {
                  "@type": "Object",
                  "fields": [
                    {
                      "name": "wasmModuleId",
                      "schema": "string"
                    },
                    {
                      "name": "wasmStartConfig",
                      "schema": "string"
                    }
                  ]
                }
              }
            ]
          }
        },
        "response": {
          "name": "rspParams",
          "schema": {
            "@type": "Object",
            "fields": [
              {
                "name": "statusCode",
                "schema": "integer"
              },
              {
                "name": "description",
                "schema": "string"
              }
            ]
          }
        }
      },
      {
        "@type": "Command",
        "name": "stopModule",
        "request": {
          "name": "reqParams",
          "schema": {
            "@type": "Object",
            "fields": [
              {
                "name": "appId",
                "schema": "string"
              },
              {
                "name": "rpcStopModuleReqParams",
                "schema": {
                  "@type": "Object",
                  "fields": [
                    {
                      "name": "wasmModuleId",
                      "schema": "string"
                    }
                  ]
                }
              }
            ]
          }
        },
        "response": {
          "name": "rspParams",
          "schema": {
            "@type": "Object",
            "fields": [
              {
                "name": "statusCode",
                "schema": "integer"
              },
              {
                "name": "description",
                "schema": "string"
              }
            ]
          }
        }
      },
      {
        "@type": "Command",
        "name": "getModuleStatus",
        "request": {
          "name": "reqParams",
          "schema": {
            "@type": "Object",
            "fields": [
              {
                "name": "appId",
                "schema": "string"
              },
              {
                "name": "rpcGetModuleStatusReqParams",
                "schema":
                {
                  "@type": "Object",
                  "fields": [
                    {
                      "name": "wasmModuleIds",
                      "schema": {
                        "@type": "Array",
                        "elementSchema": "string"
                      }
                    }
                  ]
                }
              }
            ]
          }
        },
        "response": {
          "name": "rspParams",
          "schema": {
            "@type": "Array",
            "elementSchema": {
              "@type": "Object",
              "fields": [
                {
                  "name": "wasmModuleId",
                  "schema": "string"
                },
                {
                  "name": "wasmModuleStatus",
                  "schema": {
                    "@type": "Enum",
                    "valueSchema": "string",
                    "enumValues": [
                      {
                        "name": "running",
                        "enumValue": "running"
                      },
                      {
                        "name": "stopped",
                        "enumValue": "stopped"
                      },
                      {
                        "name": "noexist",
                        "enumValue": "noexist"
                      }
                    ]
                  }
                },
                {
                  "name": "startTime",
                  "schema": "string"
                },
                {
                  "name": "timeSinceStart",
                  "schema": "string"
                }
              ]
            }
          }
        }
      }
    ]
  }
]
